---
title: Примеры
description: Примеры использования фрагментов кода
---

## Аргументы команды {#command-arguments}

Пример ниже объявляет переменную `reason` и присваивает ей [значение аргумента](data-types/commandoption.mdx) **причина**. Если значение аргумента не указано, то вернёт `undefined`.

```javascript
{{ let reason = command.options.find(i => i.name === 'причина') }}

// теперь можно использовать эту переменную где угодно
{{ reason.name }} // название аргумента
{{ reason.value }} // значение аргумента
```

Мы также можем получить объект [`user`](data-types/user.mdx), если установленный тип аргумента **ПОЛЬЗОВАТЕЛЬ**.

```javascript
{{ let user = command.options.find(i => i.name === 'пользователь') }}

{{ user.user.username }} // имя пользователя
{{ user.value }} // идентификатор пользователя
```

Обратите внимание, что в примере идёт обращение к свойству `user`, а не к `value`. Свойство `value` в данном случае будет иметь значение идентификатора упомянутого пользователя.

Со всеми свойствами объекта `command` можно ознакомиться [здесь](data-types/command.mdx).

## Хранение значений {#values-storing}

Мы можем хранить какие-нибудь значения для их дальнейшего использования с помощью функции [`setValue`](functions.mdx#setvalue) и [`getValue`](functions.md#getvalue).

Например можно сохранить дату последнего использования команды:

```javascript
// объявляем переменную и присваеваем
// ей значение текущей временной метки
{{ const now = Date.now() }}
// ИЛИ
{{ const now = new Date().getTime() }}

// сохраняем значение переменной 'now' в хранилище
{{
setValue(`${command.id}.${member.user.id}.lastUse`, now)
}}

// получаем сохраненные данные
// если ключа не существует, то вернёт undefined
{{
const lastUse = getValue(`${command.id}.${member.user.id}.lastUse`)
}}
```

В примере выше мы использовали [шаблонные строки](https://developer.mozilla.org/ru/docs/Web/JavaScript/Reference/Template_literals) для ключей хранилища. Рекомендуется указывать уникальный ключ для разных значений, в противном случае данные будут перезаписаны. В примере выше в ключе значения присутствует идентификатор пользователя. Если команду использует другой пользователь, то для него будут другие данные в хранилище.

## Случайное значение

Этот пример покажет, как создавать и использовать функцию, которая случайным образом выбирает одно указанное значение.

```javascript
// создаём функцию 'choose' с помощью
// ключевого слова 'function'
{{
function choose(...args) {
  // случайное число от 0 до количества введенных аргументов
  const randomNum = Math.floor(Math.random() * args.length)
  // возвращаем значение через ключевое слово 'return'
  return args[randomNum]
}
}}

// вызываем её и передаём аргументы через запятую
// функция вернёт случайный введенный в неё аргумент
{{ choose('какое-нибудь', 'случайное', 'значение') }}
```

## Проверка разрешений

Если вы хотите, чтобы в пользовательской команде была проверка на права, то вам нужно добавить условие **Сравнение значений** и выбрать оператор **РАВНО**.

У объекта [`member`](data-types/member.mdx) есть свойство `permissions` и оно является массивом [разрешений](https://discord.com/developers/docs/topics/permissions#permissions-bitwise-permission-flags) участника.

```javascript
// здесь мы проверяем есть ли право
// администратора у текущего пользователя
{{ member.permissions.includes('ADMINISTRATOR') }}

// вернёт true, если есть право администратора и false, если права нет
```

Чтобы сделать проверку, нам нужно в условии **Сравнение значений**, в поле **Левая часть** указать то, что указано в примере выше, а в поле **Правая часть** указать `{{ true }}`.

Таким образом, если значение `member.permissions.includes('ADMINISTRATOR')` равняется `false`, то выполнение последующих компонентов будет остановлено.

Рекомендуется выбрать опцию **Ложный ответ** и указать сообщение, которое будет отравлено, если **Левая часть** условия будет равна `false`.

## Проверка наличия роли

:::info

Проверку наличия роли можно выполнить только для автора команды, т.е. участника, вызвавшего её.

:::

Проверка наличия определённой роли у участника в пользовательских командах делается аналогично вышеописанной проверке разрешений, однако в данном случае меняется содержимое поля **Левая часть**.

```javascript
// здесь мы проверяем наличие конкретной роли
// у пользователя, вызвавшего команду
{{ member.roles.map((role) => role.id).includes("ROLE_ID") }}

// вместо ROLE_ID должен быть указан ID роли на сервере
```

:::warning

В кавычках вместо `ROLE_ID` необходимо указать ID роли, наличие которой вы хотите проверить.

:::

## Выдача валюты

Действие **Изменить кошелёк** позволяет прибавлять или убавлять валюту участникам. Например, вы хотите добавить команду ежедневной награды, для этого добавьте действие **Изменить кошелёк** в свою команду, в поле **Оператор** выберите **ПРИБАВИТЬ** и укажите в поле **Количество валюты** сколько нужно прибавить.

Чтобы команда срабатывала с перерывом, нужно настроить **Ограничение использования**.

Также в компоненте есть поле Идентификатор пользователя и Идентификатор валюты. Первое пригодится, если вы хотите выдать валюту другому пользователю, а не автору команды, а второе – для того, чтобы выдать другую валюту, а не стандартную, которая создаётся автоматически.

Валюты сервера можно получить обратившись к свойству `guild.economyCurrencies`, например:

```javascript
{{
const defaultCurrency = guild.economyCurrencies.find(i => i.id === 'DEFAULT')
}}

{{ defaultCurrency }} // { id: 'DEFAULT', name: 'Cash', symbol: '$' }
```

:::info

Действие **Изменить кошелёк** не будет выполнено, если экономика отключена на сервере.

:::
